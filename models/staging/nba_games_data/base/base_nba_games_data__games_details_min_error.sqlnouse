WITH partidos_cero AS (SELECT DISTINCT(game_id) FROM ALUMNO27_DEV_BRONZE_DB.__NBA_GAMES_DATA.GAME_DETAILS where min like '0')
--los partidos con min negativos son 1800035 y 1800045 que estan incluidos en los de 0
   
   ,partidos AS (SELECT 
                a.game_id,
                a.min,
                a.team_city FROM ALUMNO27_DEV_BRONZE_DB.__NBA_GAMES_DATA.GAME_DETAILS a
                JOIN partidos_cero b
                ON a.game_id = b.game_id
                
                ),
    confecha AS (
        SELECT  a.game_id,
                a.min,
                a.team_city,
                b.game_date_est,
                b.pts_away,
                b.pts_home
                FROM partidos a 
                JOIN ALUMNO27_DEV_BRONZE_DB.__NBA_GAMES_DATA.GAMES b 
                ON a.game_id = b.game_id
                ) 
               -- SELECT * FROM confecha;
------------confirmado con chatgpt que eran todos de pretemporada ,el ultimo es  25 de octubre de 2013            
            SELECT DISTINCT(game_id),
                        game_date_est
                        FROM confecha
                        order by game_id;

SELECT distinct(game_id), min FROM ALUMNO27_DEV_BRONZE_DB.__NBA_GAMES_DATA.GAME_DETAILS where min LIKE '0.%';

-- SELECT * FROM ALUMNO27_DEV_BRONZE_DB.__NBA_GAMES_DATA.GAME_DETAILS where game_id = 42100223 ;
WITH partidos_cero_punto AS (SELECT distinct(game_id) FROM ALUMNO27_DEV_BRONZE_DB.__NBA_GAMES_DATA.GAME_DETAILS where min LIKE '0.%'),

partidos AS (SELECT 
                a.game_id,
                a.min,
                a.team_city FROM ALUMNO27_DEV_BRONZE_DB.__NBA_GAMES_DATA.GAME_DETAILS a
                JOIN partidos_cero_punto b
                ON a.game_id = b.game_id),
                
partidos_con_fecha AS
    (SELECT     a.game_id,
                a.min,
                a.team_city,
                b.game_date_est,
                b.pts_away,
                b.pts_home
                FROM partidos a 
                JOIN ALUMNO27_DEV_BRONZE_DB.__NBA_GAMES_DATA.GAMES b 
                ON a.game_id = b.game_id
)
--SELECT * FROM partidos_con_fecha;
SELECT DISTINCT(game_id),
                        game_date_est
                        FROM partidos_con_fecha
                        order by game_id;

-- GAME_ID que si son de liga regular 22101043 y uno de playoff 42100223


SELECT * FROM ALUMNO27_DEV_BRONZE_DB.__NBA_GAMES_DATA.GAME_DETAILS where game_id = 22101043